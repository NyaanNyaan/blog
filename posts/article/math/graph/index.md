---
title: "Graph"
date: 2020-10-26T23:53:01+09:00
draft: false
tags: ["math"]
---

グラフに関して勉強したことを適宜まとめていく。(ほとんどゼロからのスタートなので間違いがあるかも…)

<!-- @import "[TOC]" {cmd="toc" depthFrom=1 depthTo=6 orderedList=false} -->

<!-- code_chunk_output -->

- [基本](#基本)
  - [握手補題](#握手補題)
  - [エルデシュガライの定理](#エルデシュガライの定理)
- [平面グラフ](#平面グラフ)
  - [性質](#性質)
  - [地図の彩色](#地図の彩色)
    - [六色定理](#六色定理)
  - [美術館定理](#美術館定理)
    - [証明](#証明)
- [二部グラフ](#二部グラフ)
  - [性質](#性質-1)
  - [最大マッチング](#最大マッチング)
  - [最小点被覆](#最小点被覆)
  - [Hallの結婚定理](#hallの結婚定理)
    - [例題1](#例題1)
    - [例題2](#例題2)
- [数え上げ](#数え上げ)
  - [ケイリーの公式](#ケイリーの公式)
    - [Pruefer Code](#pruefer-code)
    - [double counting](#double-counting)
    - [形式的冪級数](#形式的冪級数)
    - [ケイリーの公式の派生版](#ケイリーの公式の派生版)
  - [行列木定理(Kirchhoff's theorem)](#行列木定理kirchhoffs-theorem)
    - [多項式行列への適用](#多項式行列への適用)
  - [完全マッチングの数え上げ](#完全マッチングの数え上げ)
    - [二部グラフの場合](#二部グラフの場合)
    - [一般のグラフの場合](#一般のグラフの場合)

<!-- /code_chunk_output -->

## 基本



### 握手補題

  - 基本的な定理

  - 無向グラフ$G(V,E)$の頂点$v$の次数を$d_v$とおくとき、$\sum_{v \in V} d_v = 2|E|$が成り立つ

  - この性質から次の事実が従う
    
    - グラフの頂点の次数の総和は偶数
    - 次数が奇数であるような頂点の個数は偶数個

### エルデシュガライの定理

  - グラフの次数が与えられたときに条件を満たすグラフを構築できるかを判定できる定理

  - グラフの次数を降順に並べた列(次数列と呼ぶ)$d_1,\ldots,d_n$が与えられる。この時、条件を満たすグラフが存在する必要十分条件は次の二つである

    - $\sum_{v \in V}d_v$ が偶数
    - $\sum_{i=1}^k d_i \leq k(k-1)+\sum_{i=k+1}^n \min(d_i,k)\ (i=1,\ldots n)$
  
  - 必要性は容易に示せる
    - $d_1,\ldots,d_k$に対応する頂点集合の次数の和の取りうる最大値を考える
      - 集合の内部同士の全てに辺を張った時、次数は$k(k-1)$増える
      - 集合の内部から外部の次数$d$の頂点に出来る限り辺を張った時、次数は$\min(d,k)$増える
      - よって最大値は$k(k-1)+\sum_{k\lt j} \min(d_j,k)$になる
  - 十分性は難しいらしい

## 平面グラフ

- グラフ$G$を平面上に描いた時に辺同士が端点以外に共有点を持たない時、$G$を平面グラフと呼ぶ

- 平面グラフと同型なグラフを平面的グラフと呼ぶ
  - つまり、平面的グラフの頂点や辺を適切に移動すると平面グラフになる

### 性質

- 平面グラフの辺$e$が$G$の切断辺$\leftrightarrow e$を境界に持つ面は唯一

- オイラーの公式：平面グラフの頂点数を$n$、辺数を$m$、面数を$f$、連結成分の数を$k$としたとき
  $$n-m+f=1+k$$
  - 帰納的に証明出来る
  - 頂点を$1$個増やすと連結成分が$1$個増える
  - 辺を$1$本増やすと連結成分が$1$個減るか面が$1$個増える

- 連結な平面的グラフについて、$n \geq 3$の時、$m \leq 3n - 6$
  - 一つの面が接する辺は$3$以上($n>3$を仮定)
  - 一つの辺が接する面は$2$以下
  - よって$3f \leq 2m$
  - オイラーの公式に代入して
  $$2\leq 1+k=n-m+f\leq n-m+\frac{2}{3}m$$
  $$\leftrightarrow m\leq 3n-6$$
  が従う
  - $n=3$の時は場合分けして示せる

- $G$の双対グラフ$G*$は平面的グラフ

- Kuratowskiの定理：平面的グラフ$G$は$K_5,K_{3,3}$をマイナーに含まない

### 地図の彩色  

- 地図を隣り合う領域同士が異なる色で塗り分けることを考える

- 領域を頂点に対応させて、隣接する領域同士に辺を貼ったグラフを地図の双対グラフと呼ぶ
  
- 地図の双対グラフは平面的グラフである
  - 平面的グラフの彩色が出来れば地図の彩色もできる

- 任意の平面的グラフは4彩色が可能(四色定理)
  - 証明はコンピュータが必要
  - 一方、6彩色が可能なことはオイラーの公式から比較的容易に従う(六色定理)

#### 六色定理

  - 補題：平面的グラフには必ず次数が$5$以下の頂点が存在する
    - オイラーの公式より$m\leq 3n-6$
    - 握手補題より平均次数$\langle d\rangle=\frac{2m}{n}$
    - $\therefore \langle d\rangle \leq \frac{2\cdot (3n-6)}{n}<6$
    - よって$d<6$の頂点が存在する
  - 帰納的に証明する
    - 頂点数$n+1$の平面的グラフ$G$が存在する
    - 補題より次数$5$以下の頂点が存在してそれを$v$とおく
    - グラフ$G-v$を考えると、$G-v$は平面グラフなので$6$彩色可能
    - グラフ$G$の$v$に隣接する頂点の個数は$5$以下
    - よって、グラフ$G$の頂点のうち$v$以外はグラフ$G-v$の$6$彩色と同じ色で塗り、$v$は隣接する頂点に使われていない色で塗れば$6$彩色可能

### 美術館定理

- 頂点数$n$の任意の多角形は高々$\lfloor \frac{n}{3}\rfloor$人の監視員で監視可能

#### 証明
  - 多角形を三角形分割したものをグラフとみなす
  - このグラフは全ての頂点が外面の境界上にある(外平面グラフ)
  - 補題：外平面グラフは$3$彩色可能
    - 外平面グラフ$G$を双対グラフとして持つ地図を考えると、全ての部分領域が外面の境界と接するような地図になる
    - 外面を平面として加える新たな地図を作る
    - この地図は$4$彩色可能で、この時、外面以外の面は外面の色と異なる$3$色で塗られている
    - よって地図の双対グラフは$3$彩色可能
  - 三角形分割したグラフを$3$彩色した時、それぞれの三角形は異なる3色で塗られている
  - よって$3$色のうち最も少ない色を選びそこに監視員を置けば全ての三角形を監視することが出来る
    - 監視員の人数は高々$\lfloor \frac{n}{3}\rfloor$人になる

## 二部グラフ

### 性質
(適宜追加)
- 奇数長の閉路を持たない
- 最大マッチングは多項式時間で求まる
- 最大マッチングの辺数と最小点被覆の点数が等しい

### 最大マッチング

- 頂点集合$U,V$と超頂点$S,T$について、

  - $S$から$U$内の点に流量$1$の辺
  - 元のグラフの辺の張られている部分に$U$から$V$の向きに流量$1$の辺
  - $V$から$T$内の点に流量$1$の辺

- を貼ると$S$から$T$への最大流が最大マッチングと一致

- 計算量はDinic法で$\mathrm{O}(M^{\frac{3}{2}})$　(もっと早いアルゴリズムもありそう？) [実装](https://nyaannyaan.github.io/library/flow/flow-on-bipartite-graph.hpp)

### 最小点被覆

- 点被覆とは部分集合$C \subset V$で、グラフ$G$の全ての辺が$C$の頂点に接続しているもの
  - 最小点被覆は点被覆のうちサイズが最小のもの

- 一般のグラフで、最大マッチング$M$と最小点被覆$C$の間には$|M| \leq |C|$という関係が成り立っている(弱双対性)

- これに加えて、二部グラフでは$|M|=|C|$が成り立つ(強双対性) (Königの定理)
  - 最大マッチングを求めるときに作ったグラフの最小カットが最小点被覆に対応しており、最大流最小カット定理から$|M|=|C|$になる

- TODO:実装する　[参考](https://www.slideshare.net/drken1215/ss-86894312)

### Hallの結婚定理

- 二部グラフの片方の頂点集合を全て含むマッチングが存在するかを判定するのに使える定理

- 頂点集合$U,V$からなる二部グラフ$G$に対して次の二つの命題は同値

  - $U$に含まれる全ての頂点をカバーするマッチングが存在する
  - 任意の$U$の部分集合$A$と$A$の近傍$\Gamma(A)$について$|A|\leq|\Gamma(A)|$が成り立つ。

#### 例題1

- 52枚のトランプを4枚ずつ13組に分けた時、各組からカードを1枚ずつ選んで1~13が1枚ずつ含まれる組を作れることを示せ。

  - 頂点集合$A:\lbrace a_1\ldots a_{13}\rbrace$:カードの組
  - 頂点集合$B:\lbrace b_1\ldots b_{13}\rbrace$:カードの数字
  - $i$番目の組に数字$j$の書かれたカードが存在するときに$a_i$と$b_j$に辺を貼る
  - すると条件を満たす構築は$A$をカバーするマッチングと一致する
  - よって$\forall S\subset A,|S|\leq |\Gamma(S)|$を示せればよい
  - $S$には$4|S|$枚のカードが含まれ、一つのカードは$4$枚しかないので種類数が$|S|$未満だと矛盾、よって少なくとも$|S|$種類の数字が存在する
  - よって$|S|\leq|\Gamma(S)|$が示された

#### 例題2

- 4目並べ(縦横のみ)が引き分けなのを示せ。
  
  - 頂点集合$A$:マス目に対応する頂点
  - 頂点集合$B$:縦横の列に対応する頂点、各列につき2つずつ
  
  - マス目の頂点とマス目に対応する列頂点の間に辺を張ると二部グラフが出来る
  
  - このグラフが列頂点をカバーするマッチングが存在することを示す
    - $A,B$内の頂点の次数は全て$4$
    - $S \subset B$なる頂点の次数の和は$4|S|$
    - 一方$|\Gamma(S)|$の次数の和は$4|\Gamma(S)|$
    - よって$S$に隣接する辺の本数を$M$とすると$4|S|=M\leq 4|\Gamma(S)|$となり、$|S|\leq |\Gamma(S)|$が従う。
    - (例題1と同様に示すこともできる)
  
  - よってマッチングは存在する。この時、一つの列に対して二つのマス目の頂点が対応するマッチングが出来ている
  
  - 後手は次のような戦略を取れば負けない
    - 一つの列に対応する二つの頂点のマス目同士でペアを作る
    - 先手があるマスを取った時、後手はマス目の含まれるペアのもう片方のマスを取ることを繰り返す
    - 任意の列に対してペアは存在するため、全ての列は少なくとも先手が1マス、後手が1マスを取っている
    - よって全ての列は4マス揃わないので引き分けに持ち込める
  - 同様の方法で先手も負けることはない。よって両者が最善を尽くすと引き分けになる

- [参考1(電通大の講義資料)](http://dopal.cs.uec.ac.jp/okamotoy/lect/2019/gn/lect05.pdf)　[参考2(高校数学の美しい物語)](https://mathtrain.jp/hall)

## 数え上げ

### ケイリーの公式

- $n$頂点のラベル付き木の個数が$n^{n-2}$であるという公式

- 様々な証明方法が知られている 

- [Wikipedia](https://ja.wikipedia.org/wiki/%E3%82%B1%E3%82%A4%E3%83%AA%E3%83%BC%E3%81%AE%E5%85%AC%E5%BC%8F)　[参考(joisinoさんの記事)](http://joisino.hatenablog.com/entry/2017/08/20/200000)

#### Pruefer Code

- $N$頂点の木と一対一対応がなされた、$1$から$n$までの整数からなる長さ$n-2$の数列をPruefer Codeと呼ぶ

- 木に対して次の操作を$i$回行うことでPruefer Codeである数列$A$を得ることが出来る
  - $i$回目の操作では、現在の葉のうち最も番号の小さい頂点を$v$、$v$に隣接する頂点を$A_i$として、$v$を木から取り除く

- また、逆写像は次の操作によって得ることが出来る

  - $i$回目の操作では$v_1, \ldots, v_{i-1}$および$A_i,\ldots,A_{n-2}$に含まれない頂点のうち最も若い番号を$v_i$として、$v_i$と$A_i$の間に辺を張る
  - 最後に$v$に登場しなかった$2$つの頂点の間に辺を張る
  - [実装](https://nyaannyaan.github.io/library/tree/pruefer-code.hpp)

- Pruefer Codeは全単射であることがわかるので、木の個数は$n^{n-2}$になる

#### double counting

- double countingとは、集合の大きさを二つの方法で数え上げることで等式を証明する方法のこと

- ラベル付き頂点とラベル付き辺を持つ、$n$頂点の根付き有向木$U(n)$を二つの方法で数え上げる

- (1) ラベル付き頂点を持つ木に根と辺の向きをつける方法で数える
  
  - 根の選び方は$n$通り、辺の選び方は$(n-1)!$通りになる
  - $n$頂点のラベル付き頂点を持つ木の個数を$T(n)$とおくと、
  $$U(n) = T(n)\cdot n\cdot (n-1)!=T(n)n!$$
  がわかる

- (2) ラベル付き頂点が$n$個ある空グラフにラベル付き辺を$1$本ずつ加えていく方法で数える
  - $k$回目に辺を加える時、グラフは$n-k+1$個の根付き森からなることを考えると、加える場所は始点が$n$通り、終点は自身を含む木以外の根の$n-k$通りとなる
  - よって$n-1$回の辺の追加によって出来る木の個数は
  $$U(n)=\Pi_{i=1}^{n-1}n(n-k)=n^{n-1}(n-1)!$$
  となる

- (1)(2)より
$$U(n)=T(n)n!=n^{n-1}(n-1)!$$
が示されるので、両辺を$n!$で割って
$$T(n)=n^{n-2}$$
となる

#### 形式的冪級数

- ラグランジュの反転公式は関数$f(\omega)=x$に対して$g(x)=\omega$である逆関数を求める公式

- 数え上げでは主に次の2つしか使わない(らしい)

  - (1)$f(\omega) = \frac{\omega}{\phi(\omega)}$であるとき任意の関数$H$に対して
  $$[x^n]H(g(x))=\frac{1}{n}[\omega^{n-1}]\left(H(\omega)'\phi(\omega)^n\right)$$
  とくに$H$が恒等写像のとき
  $$[x^n]g(x)=\frac{1}{n}[\omega^{n-1}]\phi(\omega)^n$$

  - (2)関数$g(x)$が$g(x) = a + x\phi(g(x))$を満たすとき、
  $$[x^n]g(x) = \frac{1}{n!} \left|\frac{d^{n-1}}{d \omega ^{n-1}} \left(\phi(\omega)^n\right)\right|_{\omega=a}$$
  とくに$g(x) = x\ \phi(g(x))$のとき
  $$[x^n]g(x)=\frac{1}{n}[\omega^{n-1}]\phi(\omega)^n$$

- $n$頂点からなる根付き木の総数を$R_n$とおく

- $R_n$の値を根とつながっている子の個数ごとで場合分けして数え上げる
  - 子が0個のとき $[n=1]$
  - 子が1個のとき $n\cdot R_{n-1}$
  - 子が2個のとき $\frac{n}{2!}\sum_{i+j=n-1}R_iR_j \ _{n-1}C_i$
  - 子が3個のとき $\frac{n}{3!}\sum_{i+j+k=n-1}R_iR_jR_k \frac{(n-1)!}{i!j!k!}$
  - 一般に子が$k$個のとき
  $\frac{n}{k!}\sum_{k_1+\ldots+k_m=n-1}R_{k_1}R_{k_2}\ldots R_{k_m}\frac{(n-1)!}{k_1!k_2!\ldots k_m!}$

- ここで$R(n)$のEGFを$F(x)$とおくと
  $$R_n=n[x^{n-1}]\left(1 + F(x)+\frac{F(x)^2}{2!}+\frac{F(x)^3}{3!}+\ldots\right) = n([x^{n-1}]e^{F(x)})$$
  より$F(x)=xe^{F(x)}$が従う。

- よって$R_n$はラグランジュの反転公式に$\phi (\omega)=e^\omega$を代入すれば求まり、
$$R_n=\left|\frac{d^{n-1}}{d \omega ^{n-1}} e^{n\omega}\right|_{\omega=0}=n^{n-1}$$
  となる

- また、$n$頂点の根無し木1個につき$n$個の根の選び方が存在することから、$n$頂点の根無し木の個数は$n^{n-2}$とわかる

#### ケイリーの公式の派生版

- 一般化ケイリーの公式
  - $n$頂点、$k$個の連結成分からなり、頂点$1$から頂点$k$が異なる連結成分に属するようなラベル付き森の個数は$T_{n,k}=k n^{n-k-1}$
  - 証明：double countingで考える
    - $1$から$K$を根とする  頂点ラベル・辺ラベル付き森の個数は？
    - (1) ラベル付き森に根をつける… $T_{n,k} (n-k)!$個
    - (2) $n$頂点の辺のないグラフからスタートして$n-k$本のラベル付き辺を辺$1$から辺$n-k$まで順に貼る
      $i$本目は$n(n-i)$通りあるので全体で$n^{n-k} \frac{(n-1)!}{(k-1)!}$通り
    - そのうち根が$1$から$k$であるものは全体の$\frac{1}{\ _n C_k\ }=\frac{k!(n-k)!}{n!}$なので、
    $$n^{n-k} \frac{(n-1)!}{(k-1)!}\cdot \frac{k!(n-k)!}{n!}=kn^{n-k-1}(n-k)!$$
    - (1)(2)より $T_{n,k}=k n^{n-k-1}$を得る

- 次数制限付きケイリーの公式
  - 次数列$d_1,d_2,\ldots,d_n(d_i > d_j)$に対して、頂点$i$の次数が$d_i$であるような$n$頂点のラベル付き木の個数は
  $$\frac{(n-2)!}{(d_1-1)!\ldots (d_n-1)!}$$
  - 証明1：数学的帰納法
    - $N \geq 3$の時を帰納的に示せばよい
    - $\sum_i d_i = 2N-2 < 2N$かつ$\forall (i,j), d_i \geq d_j$より$d_N=1$が従う
    - よって頂点$N$および頂点$N$の隣接する辺を取り除いたグラフも$N-1$頂点の木になる
    - $N$に隣接する点が$j$であるようなグラフ$G_j$の数え上げを考える(ただし$d_j > 1$)
    - $G_j$に対して次数列$d_1,d_2,d_{j-1},\ldots,d_j-1,\ldots,d_{N-1}$を満たすグラフが一対一対応しているので
    $$\lvert G_j \rvert = \frac{(n-3)!}{(d_1-1)!\ldots (d_j-2)! \ldots (d_{n-1}-1)!}$$
    - 変形すると
    $$\lvert G_j \rvert = (d_j-1)\cdot\frac{(n-3)!}{\Pi_{1\leq j\leq n-1}(d_j-1)!}$$
    - $|G_j|$全ての$j$に対して足し合わせたものが答え
    $$|G| = \sum_{j,d_j\neq 1} |G_j|=\sum_{j,d_j \neq 1}\frac{(d_j-1)(n-3)!}{\Pi_{1\leq j\leq n-1}(d_j-1)!}$$
    $$=\sum_{j}(d_j-1)\cdot\frac{(n-3)!}{\Pi_{1\leq j\leq n-1}(d_j-1)!}$$
    $$=\sum_{j}(d_j-1)\cdot\frac{(n-3)!}{\Pi_{1\leq j\leq n-1}(d_j-1)!}$$
    $$=(2n-3-(n-1))\cdot\frac{(n-3)!}{\Pi_{1\leq j\leq n}(d_j-1)!}$$
    $$= \frac{(n-2)!}{\Pi_{1\leq j\leq n}(d_j-1)!}$$
    となり、以上より示された
  - 証明2: Pruefer Code
    - Pruefer Codeにおいて頂点$i$の次数は(列での$i$の出現回数)+1
    - よって多項定理から$\frac{n-2}{\Pi_i (d_i-1)}$が容易に従う
    - [参考:37zigenさんのPruefer Codeの記事](https://37zigen.com/prufer-code/)
  
### 行列木定理(Kirchhoff's theorem)

- 無向グラフ$G$に対してラプラシアン行列$L=(l_{ij})$を
$$l_{ij}=\begin{cases}\deg(v_i) & i=j \newline -1 & i \neq j \ \mathrm{and}\ v_i\ \mathrm{is}\ \ \mathrm{adjacent}\ \mathrm{to}\ v_j \newline 0 & \mathrm{otherwise} \end{cases}$$
  により定める

- この時、$L$の余因子はグラフの全域木の個数に等しい。これを行列木定理と呼ぶ

- また、$L$の固有値の$0$の個数はグラフ$G$の連結成分の個数と一致する

#### 多項式行列への適用

- 次のような問題を解くのに使用される
  - 例題：辺が赤か青のいずれか塗られた$N$頂点のグラフがある。($N \leq 100$)　$0\leq i < N$に対して赤が$i$本含まれる全域木の個数を求めよ。
- 解法：辺が赤いときに重み$x$の辺を貼り青いときに$1$の辺を貼ると余因子の$i$次の係数が赤$i$本含まれる全域木の個数に対応する
- 愚直にやると実装が面倒だが、行列式は高々$N-1$次なので$x = 0,\ldots N-1$に対して行列式を求めて多項式補間すれば$\mathrm{O}(N^4)$で容易に解ける (ユークリッドの互除法でも行けるらしい　[参考](https://noshi91.hatenablog.com/entry/2020/11/28/115621))

- 高度典型枠で時々出題されている
  - [EXPTREES(cheflong 2020-07)](https://www.codechef.com/problems/EXPTREES)
  - [Inconvenient Kingdom(yuki 1303)](https://yukicoder.me/problems/no/1303) (この問題は0次・1次の係数のみで十分なためad-hocな解法でも解ける)

### 完全マッチングの数え上げ

#### 二部グラフの場合

- 部集合$A,B$がともに$|A|=|B|=n$である二部グラフ$G$の完全マッチングを数える

- 完全マッチングについて、$A$の$i$番目と$B$の$\sigma(i)$番目が対応していると考えると$\sigma$は順列になる

- よって行列$M=m_{i,j}$を$m_{i,j}$が$A_i$と$B_j$の間の辺の本数と等しくなるように定めると、完全マッチングの個数は$M$のパーマネント
$$\mathrm{perm}\ M = \sum_\sigma \Pi m_{i,\sigma(i)}$$
と等しくなる

- パーマネントの計算は$n$に対して指数時間かかるが、偶奇だけは容易に求まる
  - 行列式
  $$\det M=\sum_\sigma\mathrm{sgn}(\sigma) \Pi m_{i,\sigma(i)}$$
  は$\mod 2$を取るとパーマネントと一致するので、掃き出し法+bitset高速化により$\mathrm{O}\left(\frac{n^3}{w}\right)$で計算できる($w$はワードサイズ)
- [関連資料](http://dopal.cs.uec.ac.jp/okamotoy/lect/2020/dme/lect05.pdf)

#### 一般のグラフの場合

- サイズ$2n$の正方行列$A$に対してハフニアン$\mathrm{haf}(A)$は次のように定められる
$$\mathrm{haf}(A) = \sum_{\sigma \in C_{2n}}\Pi_{i=1}^n A_{\sigma(2i-1),\sigma(2i)}$$
ただし$C_{2n}$は$\forall i,C_{2i-1} \lt C_{2i+1}$かつ$\forall i,C_{2i-1}\lt C_{2i}$を満たす順列の集合
- サイズ$2n$のグラフ$G(V,E)$に対して$(a_{ij})=[(i,j)\in E]$となるような行列を$A$とおくと、$G$の完全マッチングの個数は$\mathrm{haf}(A)$に一致する
  - $\mathrm{haf}(A)$の計算では全ての完全マッチングに対応する$a$の積が1回ずつ足されている
- TODO：[Hafnian of Matrix(Library Checker)](https://judge.yosupo.jp/problem/hafnian_of_matrix)を解く
  - [論文](https://arxiv.org/pdf/1107.4466.pdf)　読解にinf回挫折している…
  - 事前準備
    - $\lbrace {1,2,\ldots,m}\rbrace$の部分集合全てを要素に持つ集合を$[m]$と表す
    - $[m]$の部分集合全てに対して環を拡張したものを$R[U_m]$とおく
      - この辺の正しい表現が分からない…イメージとしては$2^m$次のFPSだと思っておけばいい
    - 集合$S$に関連する値を$r_S$のようにおき、$r\in R[U_m]$に対して
    $$r=\sum_{S\subseteq [m]}r_S[S]$$
    のように表す
      - イメージとしてはいつものFPSの「$2$次の項は$2x^2$」が「$S$に関連する項は$r_S[S]$」に置き換わったイメージ
    - 加法を$+$、乗法を[subset convolution](https://nyaannyaan.github.io/library/set-function/subset-convolution.hpp)で定義する
      - $1[\phi]$が乗法的単位元になる
  - ハフニアンの求め方
    - (実装のため論文と違う添え字で解いているので注意)
    - 行列$B \in R^{2n\times 2n}$のハフニアン$h$を計算したい
    - $B,h$に対して$\mathrm{squeeze}$と呼ばれる操作を$n$回行う
      - 初項は$B^{(0)}=B,h^{(0)}=1[\phi]$
      - $i$回目の操作では$B^{(i-1)}\in R[U_{i-1}]^{(2n-2i+2)\times (2n-2i+2)}$から$B^{i}\in R[U_i]^{(2n-2i)\times (2n-2i)}$を、$h^{(i-1)}$から$h^{(i)} \in  R[U_i]$を得る
        - 一回の操作で行列のサイズは小さくなるが、代わりに行列の要素の属する環は大きくなる
      - $B^{(i)}$と$B^{(i+1)}$の関係式は次の式で与えられる
      $$B_{j,k}^{(i)}=\begin{cases}B_{j,k}^{(i-1)}+S_{i,j,k} & j\neq k \\ 0 & j=k\end{cases}$$
      $$S_{(i,j,k)}=1[\lbrace i\rbrace]\cdot (B_{i,2n-2i+1}^{(i-1)}\cdot B_{j,2n-2i+2}^{(i-1)}+B_{i,2n-2i+2}^{(i-1)}\cdot B_{j,2n-2i+1}^{(i-1)})$$
      $$h^{(i)}=h^{(i-1)}\cdot (1[\phi]+1[\lbrace i\rbrace]\cdot B_{2n-2i+1,2n-2i+2}^{(i-1)})$$
    - $n$回の操作を行った後、$h_{[n]}^{(n)}$が求めたいハフニアンの値になる
  - 空間計算量の改善
    - Subset Convolutionと同様にzetaした状態で計算すると空間計算量が線形に落ちる
  
    