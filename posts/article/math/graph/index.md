---
title: "Graph"
date: 2020-10-26T23:53:01+09:00
draft: false
tags: ["math"]
---

グラフに関して勉強したことを適宜まとめていく。

<!-- @import "[TOC]" {cmd="toc" depthFrom=1 depthTo=6 orderedList=false} -->

<!-- code_chunk_output -->

- [基本](#基本)
  - [握手補題](#握手補題)
  - [エルデシュガライの定理](#エルデシュガライの定理)
- [二部グラフ](#二部グラフ)
  - [性質](#性質)
  - [最大マッチング](#最大マッチング)
  - [Hallの結婚定理](#hallの結婚定理)
    - [例題1](#例題1)
    - [例題2](#例題2)
- [数え上げ](#数え上げ)
  - [ケイリーの公式](#ケイリーの公式)
    - [Pruefer Code](#pruefer-code)
    - [double counting](#double-counting)
    - [形式的冪級数](#形式的冪級数)

<!-- /code_chunk_output -->

## 基本



### 握手補題

  - 基本的な定理

  - 無向グラフ$G(V,E)$の頂点$v$の次数を$d_v$とおくとき、$\sum_{v \in V} d_v = 2|E|$が成り立つ

  - この性質から次の事実が従う
    
    - グラフの頂点の次数の総和は偶数
    - 次数が奇数であるような頂点の個数は偶数個

### エルデシュガライの定理

  - グラフの次数が与えられたときに条件を満たすグラフを構築できるかを判定できる定理

  - グラフの次数を降順に並べた列(次数列と呼ぶ)$d_1,\ldots,d_n$が与えられる。この時、条件を満たすグラフが存在する必要十分条件は次の二つである

    - $\sum_{v \in V}d_v$ が偶数
    - $\sum_{i=1}^k d_i \leq k(k-1)+\sum_{i=k+1}^n \min(d_i,k)\ (i=1,\ldots n)$
  
  - 必要性は容易に示せる
    - $d_1,\ldots,d_k$に対応する頂点集合の次数の和の取りうる最大値を考える
      - 集合の内部同士の全てに辺を張った時、次数は$k(k-1)$増える
      - 集合の内部から外部の次数$d$の頂点に出来る限り辺を張った時、次数は$\min(d,k)$増える
      - よって最大値は$k(k-1)+\sum_{k\lt j} \min(d_j,k)$になる
  - 十分性は難しいらしい

## 二部グラフ

### 性質
(適宜追加)
- 奇数長の閉路を持たない
- 最大マッチングは多項式時間で求まる
- 最大マッチングの辺数と最小点被覆の点数が等しい

### 最大マッチング

- 頂点集合$U,V$と超頂点$S,T$について、

  - $S$から$U$内の点に流量$1$の辺
  - 元のグラフの辺の張られている部分に$U$から$V$の向きに流量$1$の辺
  - $V$から$T$内の点に流量$1$の辺

- を貼ると$S$から$T$への最大流が最大マッチングと一致

- 計算量はDinic法で$\mathrm{O}(M^{\frac{3}{2}})$　(もっと早いアルゴリズムもありそう？) [実装](https://nyaannyaan.github.io/library/flow/flow-on-bipartite-graph.hpp)

- 最小点被覆・最大安定集合・最小辺被覆も最大マッチングから求まる　[参考](https://www.slideshare.net/drken1215/ss-86894312)

### Hallの結婚定理

- 二部グラフの片方の頂点集合を全て含むマッチングが存在するかを判定するのに使える定理

- 頂点集合$U,V$からなる二部グラフ$G$に対して次の二つの命題は同値

  - $U$に含まれる全ての頂点をカバーするマッチングが存在する
  - 任意の$U$の部分集合$A$と$A$の近傍$\Gamma(A)$について$|A|\leq|\Gamma(A)|$が成り立つ。

#### 例題1

- 52枚のトランプを4枚ずつ13組に分けた時、各組からカードを1枚ずつ選んで1~13が1枚ずつ含まれる組を作れることを示せ。

  - 頂点集合$A:\lbrace a_1\ldots a_{13}\rbrace$:カードの組
  - 頂点集合$B:\lbrace b_1\ldots b_{13}\rbrace$:カードの数字
  - $i$番目の組に数字$j$の書かれたカードが存在するときに$a_i$と$b_j$に辺を貼る
  - すると条件を満たす構築は$A$をカバーするマッチングと一致する
  - よって$\forall S\subset A,|S|\leq |\Gamma(S)|$を示せればよい
  - $S$には$4|S|$枚のカードが含まれ、一つのカードは$4$枚しかないので種類数が$|S|$未満だと矛盾、よって少なくとも$|S|$種類の数字が存在する
  - よって$|S|\leq|\Gamma(S)|$が示された

#### 例題2

- 4目並べ(縦横のみ)が引き分けなのを示せ。
  
  - 頂点集合$A$:マス目に対応する頂点
  - 頂点集合$B$:縦横の列に対応する頂点、各列につき2つずつ
  
  - マス目の頂点とマス目に対応する列頂点の間に辺を張ると二部グラフが出来る
  
  - このグラフが列頂点をカバーするマッチングが存在することを示す
    - $A,B$内の頂点の次数は全て$4$
    - $S \subset B$なる頂点の次数の和は$4|S|$
    - 一方$|\Gamma(S)|$の次数の和は$4|\Gamma(S)|$
    - よって$S$に隣接する辺の本数を$M$とすると$4|S|=M\leq 4|\Gamma(S)|$となり、$|S|\leq |\Gamma(S)|$が従う。
    - (例題1と同様に示すこともできる)
  
  - よってマッチングは存在する。この時、一つの列に対して二つのマス目の頂点が対応するマッチングが出来ている
  
  - 後手は次のような戦略を取れば負けない
    - 一つの列に対応する二つの頂点のマス目同士でペアを作る
    - 先手があるマスを取った時、後手はマス目の含まれるペアのもう片方のマスを取ることを繰り返す
    - 任意の列に対してペアは存在するため、全ての列は少なくとも先手が1マス、後手が1マスを取っている
    - よって全ての列は4マス揃わないので引き分けに持ち込める
  - 同様の方法で先手も負けることはない。よって両者が最善を尽くすと引き分けになる

- [参考1(電通大の講義資料)](http://dopal.cs.uec.ac.jp/okamotoy/lect/2019/gn/lect05.pdf)　[参考2(高校数学の美しい物語)](https://mathtrain.jp/hall)

## 数え上げ

### ケイリーの公式

- $n$頂点のラベル付き木の個数が$n^{n-2}$であるという公式

- 様々な証明方法が知られている 

- [Wikipedia](https://ja.wikipedia.org/wiki/%E3%82%B1%E3%82%A4%E3%83%AA%E3%83%BC%E3%81%AE%E5%85%AC%E5%BC%8F)　[参考(joisinoさんの記事)](http://joisino.hatenablog.com/entry/2017/08/20/200000)

#### Pruefer Code

- $N$頂点の木と一対一対応がなされた、$1$から$n$までの整数からなる長さ$n-2$の数列をPruefer Codeと呼ぶ

- 木に対して次の操作を$i$回行うことでPruefer Codeである数列$A$を得ることが出来る
  - $i$回目の操作では、現在の葉のうち最も番号の小さい頂点を$v$、$v$に隣接する頂点を$A_i$として、$v$を木から取り除く

- また、逆写像は次の操作によって得ることが出来る

  - $i$回目の操作では$v_1, \ldots, v_{i-1}$および$A_i,\ldots,A_{n-2}$に含まれない頂点のうち最も若い番号を$v_i$として、$v_i$と$A_i$の間に辺を張る
  - 最後に$v$に登場しなかった$2$つの頂点の間に辺を張る

- Pruefer Codeは全単射であることがわかるので、木の個数は$n^{n-2}$になる

#### double counting

- double countingとは、集合の大きさを二つの方法で数え上げることで等式を証明する方法のこと

- ラベル付き頂点とラベル付き辺を持つ、$n$頂点の根付き有向木$U(n)$を二つの方法で数え上げる

- (1) ラベル付き頂点を持つ木に根と辺の向きをつける方法で数える
  
  - 根の選び方は$n$通り、辺の選び方は$(n-1)!$通りになる
  - $n$頂点のラベル付き頂点を持つ木の個数を$T(n)$とおくと、
  $$U(n) = T(n)\cdot n\cdot (n-1)!=T(n)n!$$
  がわかる

- (2) ラベル付き頂点が$n$個ある空グラフにラベル付き辺を$1$本ずつ加えていく方法で数える
  - $k$回目に辺を加える時、グラフは$n-k+1$個の根付き森からなることを考えると、加える場所は始点が$n$通り、終点は自身を含む木以外の根の$n-k$通りとなる
  - よって$n-1$回の辺の追加によって出来る木の個数は
  $$U(n)=\Pi_{i=1}^{n-1}n(n-k)=n^{n-1}(n-1)!$$
  となる

- (1)(2)より
$$U(n)=T(n)n!=n^{n-1}(n-1)!$$
が示されるので、両辺を$n!$で割って
$$T(n)=n^{n-2}$$
となる

#### 形式的冪級数

- ラグランジュの反転公式は関数$f(\omega)=x$に対して$g(x)=\omega$である逆関数を求める公式

- 数え上げでは主に次の2つしか使わない(らしい)

  - (1)$f(\omega) = \frac{\omega}{\phi(\omega)}$であるとき任意の関数$H$に対して
  $$[x^n]H(g(x))=\frac{1}{n}[\omega^{n-1}]\left(H(\omega)'\phi(\omega)^n\right)$$
  とくに$H$が恒等写像のとき
  $$[x^n]g(x)=\frac{1}{n}[\omega^{n-1}]\phi(\omega)^n$$

  - (2)関数$g(x)$が$g(x) = a + x\phi(g(x))$を満たすとき、
  $$[x^n]g(x) = \frac{1}{n!} \left|\frac{d^{n-1}}{d \omega ^{n-1}} \left(\phi(\omega)^n\right)\right|_{\omega=a}$$
  とくに$g(x) = x\ \phi(g(x))$のとき
  $$[x^n]g(x)=\frac{1}{n}[\omega^{n-1}]\phi(\omega)^n$$

- $n$頂点からなる根付き木の総数を$R_n$とおく

- $R_n$の値を根とつながっている子の個数ごとで場合分けして数え上げる
  - 子が0個のとき $[n=1]$
  - 子が1個のとき $n\cdot R_{n-1}$
  - 子が2個のとき $\frac{n}{2!}\sum_{i+j=n-1}R_iR_j \ _{n-1}C_i$
  - 子が3個のとき $\frac{n}{3!}\sum_{i+j+k=n-1}R_iR_jR_k \frac{(n-1)!}{i!j!k!}$
  - 一般に子が$k$個のとき
  $\frac{n}{k!}\sum_{k_1+\ldots+k_m=n-1}R_{k_1}R_{k_2}\ldots R_{k_m}\frac{(n-1)!}{k_1!k_2!\ldots k_m!}$

- ここで$R(n)$のEGFを$F(x)$とおくと
  $$R_n=n[x^{n-1}]\left(1 + F(x)+\frac{F(x)^2}{2!}+\frac{F(x)^3}{3!}+\ldots\right) = n([x^{n-1}]e^{F(x)})$$
  より$F(x)=xe^{F(x)}$が従う。

- よって$R_n$はラグランジュの反転公式に$\phi (\omega)=e^\omega$を代入すれば求まり、
$$R_n=\left|\frac{d^{n-1}}{d \omega ^{n-1}} e^{n\omega}\right|_{\omega=0}=n^{n-1}$$
  となる

- また、$n$頂点の根無し木1個につき$n$個の根の選び方が存在することから、$n$頂点の根無し木の個数は$n^{n-2}$とわかる
