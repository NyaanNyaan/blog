---
title: "Inversion"
date: 2021-02-20T13:18:37+09:00
draft: true
---

<!-- @import "[TOC]" {cmd="toc" depthFrom=1 depthTo=6 orderedList=false} -->

<!-- code_chunk_output -->

- [反転](#反転)
  - [反転公式](#反転公式)
- [反転公式の例](#反転公式の例)
  - [二項係数の反転公式(パスカル行列)](#二項係数の反転公式パスカル行列)
    - [例題](#例題)
      - [CF 923E](#cf-923ehttpscodeforcescomcontest923probleme)
      - [LOJ575 不等関係](#loj575-不等関係httpslojacp575)
  - [スターリング数の反転公式(スターリング行列)](#スターリング数の反転公式スターリング行列)
  - [メビウスの反転公式](#メビウスの反転公式)
  - [ラグランジュの反転公式](#ラグランジュの反転公式)
  - [原始根の反転公式](#原始根の反転公式)
  - [FPS関連の反転公式](#fps関連の反転公式)
  - [高速ゼータ変換/メビウス変換/アダマール変換](#高速ゼータ変換メビウス変換アダマール変換)

<!-- /code_chunk_output -->

// 反転公式 (下に参考文献がいくつか載っている)

// https://www.cnblogs.com/ubospica/p/10618460.html

## 反転

### 反転公式

数列$f,g$が反転可能であるとは、ある行列$a,b$が存在して、

$$g_n=\sum_{i=0}^n a_{ni}f_i$$

かつ

$$f_n = \sum_{i=0}^n b_{ni}g_i$$

が成り立つことを言う。(この時$ab=I$が成り立つことが上式の片方を他方に代入することで証明できる。)

反転公式の使用方法としては、「直接計算できない数列$f$を求める時に$g$を経由して$f$を求める」という場合が多い。

- 個人的な感想としては、意識的に公式を使おうとするとしばしば混乱してしまうが、反転操作は包除原理やらゼータ変換やらFPSやらで無意識的に使っていることも多いのでうまく感覚で理解したい。

## 反転公式の例

### 二項係数の反転公式(パスカル行列)

(狭義の)包除原理に関連した反転公式。

$$f_n = \sum_{i=0}^n\binom{n}{i}g_i \leftrightarrow g_n = \sum_{i=0}^n (-1)^{n-i} \binom{n}{i}f_i$$

(いつもよくやる「1個の場合を引いて、2個の場合を足して…」を集合に対して適用すると上のような式になる。)

他にも添え字が少し違うバージョンがいくつかある。
$f$から$g$への変換は$\mathrm{O}(n \log n)$。

#### 例題

##### [CF 923E](https://codeforces.com/contest/923/problem/E)

Pascal Matrixの問題っぽい

ゴリゴリ式変形する解法もあるようだ。(読めていない) [参考](https://blog.trisolaris.top/cf923e/)


##### [LOJ575 不等関係](https://loj.ac/p/575)

> [EDPC T Permutation](https://atcoder.jp/contests/dp/tasks/dp_t)の$N \leq 10^5$版。

$\mathrm{dp}_{i,j}$:=左から順に$i$番目の数字まで決めた時、$i$番目の数が今までで$j$番目に大きい場合の数、とすると$\mathrm{O}(N^2)$で解ける。

高速化のために見方を変えて、連続する$<$の列を1つの区間として見る。すると、求める列は昇順列からなる区間が並んだもので、連続する区間は前の区間の最後の数字が後ろの区間の最初の数字より大きくなければならない。

### スターリング数の反転公式(スターリング行列)

謎。実はかなり良い性質を持っていていろんなところに顔を出すがよくわかっていない…

$f$から$g$への変換は計算量$\mathrm{O}(n \log ^2 n)$のアルゴリズムを知っているが、もっと計算量の良い方法があるかも…



### メビウスの反転公式

親の顔より見た約数/倍数変換　[ここに何か書いた](https://nyaannyaan.github.io/library/multiplicative-function/divisor-multiple-transform.hpp)　

日本でも割と流行っている　[noshi大先生のブログ](https://noshi91.hatenablog.com/entry/2020/01/15/185642)　

### ラグランジュの反転公式

包除原理とあまり関係がないのでここでは取り上げないが、FPSでよく出てくる公式。

### 原始根の反転公式

FFTです。(終わり)

### FPS関連の反転公式

$\mathrm{exp}$や$\log$や逆元です。(終わり)

### 高速ゼータ変換/メビウス変換/アダマール変換

いいよ

