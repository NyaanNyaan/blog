---
title: "ARC"
date: 2020-10-26T17:22:45+09:00
draft: false
tags: ["upsolve"]
---

ARC級のupsolveまとめ。

<!-- @import "[TOC]" {cmd="toc" depthFrom=1 depthTo=6 orderedList=false} -->
<!-- code_chunk_output -->

- [ARC](#arc)
    - [ARC105-F](#arc105-fhttpsatcoderjpcontestsarc105tasksarc105_f)
    - [ARC106-E](#arc106-ehttpsatcoderjpcontestsarc106tasksarc106_e)

<!-- /code_chunk_output -->

## ARC

#### [ARC105-F](https://atcoder.jp/contests/arc105/tasks/arc105_f)

強烈に難しい。コンテスト中は部分問題のTLE解法を思い浮かぶので精一杯。**奇数長の閉路がない$\leftrightarrow$二部グラフ**に気づくのにかなり時間がかかったのは反省。

問題文を言い換えると「連結二部グラフであるような$G$の部分グラフを数え上げよ。($N\leq 17$)」となる。

このままだと非常に数えづらいので頂点を2彩色にしたときの数え上げとして捉える。

(この部分がかなり非自明に感じる。**2彩色とすると定義しやすくなって数えやすくなる**のがある種の本質？実際、色をつけずに考察すると、集合によって数える回数が変わるため煩雑になりそう？)

それでも数えるのが大変なので、「連結」という条件を外す。つまり、

- $f(S):S\subset V$を頂点集合とする$G$の2-彩色部分グラフの数

とする。ここまで条件を取り外すと$f(S)$は非常に数えやすくなる。具体的には、$S$のうち黒く塗る頂点の集合を$A$とすると、全ての辺のうち$A$内部を結ぶ辺・$S/A$内部を結ぶ辺以外は自由に使用するかどうかを選んでよい。よって、$g(S)$:誘導部分グラフ$G[S]$の辺の数、とすると

$$f(S) = \sum_{A\subset S}2^{g(S)-g(A)-g(S/A)}$$

となる。これを利用して本丸を計算する。

- $\mathrm{dp}(S):S\subset V$を頂点集合とする$G$の2-彩色部分グラフの数

とおくと、$f(S)$から非連結グラフの場合を引けばよいとわかる。グラフが非連結であるとき、$v \in S$である点を一つ取ってきて、$v$の連結成分で場合分けをする。すると、

$$\mathrm{dp}(S) = f(S) - \sum_{v\in T \subsetneq S}\mathrm{dp}(T)f(S/T)$$

を得て、この式を利用すればdpテーブルを昇順に計算していくことが出来る。最後に、$\mathrm{dp}(V)$を2で割ったものが求める答えとなる。

#### [ARC106-E](https://atcoder.jp/contests/arc106/tasks/arc106_e)

自分の知識では相当解けない難易度だったので、本番この問題を素早く捨てられたのは運が良かった。

**解法**

条件を達成する日数を$D$日と決め打って考える。

- 頂点集合$A$:$i$番目の従業員に対応する頂点(一人につき$K$個ずつ)
- 頂点集合$B$:$j$日目に来られる人の集合

とおき、$i$番目の従業員が$j$日目に来られるときに対応する辺を貼ったグラフ$(G,A,B)$を考える。

この時、$G$は二部グラフである。また、条件を達成する組み合わせが存在することと、$A$をカバーするマッチングが存在することは同値である。

よって、[Hallの結婚定理](https://nyaannyaan.github.io/blog/article/math/graph/#hall%E3%81%AE%E7%B5%90%E5%A9%9A%E5%AE%9A%E7%90%86)より、Hall condition($A$の部分集合$S$について$|S|<$(Sに隣接する点の個数))を判定すればよい。

Hall conditionは愚直に判定すると指数時間になるので、前計算をすることで高速化する。$f(S):=$(来られる人の集合が$S$と一致するような日数)、とすると、$g(S):=$(来られる人の集合が$S$に含まれる日数)は$f(S)$に下位集合への高速ゼータ変換を適用して計算できる。この時、Hall conditionは

$|S|K \leq D - g(\lbrace1,\ldots,N\rbrace / S)$

と言い換えられるので$\mathrm{O}(1)$で判定できる。

また、$D$の上界は$2NK$であることもHallの結婚定理から示せる。問題文の条件より、全員が休みであるような日は高々$\frac{D}{2}$日である。よって$D \geq 2NK$の時、$\forall S, |S|\leq NK \leq \frac{D}{2}\leq |\Gamma{(S)}|$が従う。よって$D$の値で二分探索をすればこの問題を高速に解くことが出来る。

[提出](https://atcoder.jp/contests/arc106/submissions/17673992)　($\log$1個計算量を落とすのをサボっているため実行時間がかなり遅い。)


